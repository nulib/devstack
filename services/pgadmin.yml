variables:
  db_host: db
  db_username: docker
  db_password: d0ck3r
service_definition:
  image: dpage/pgadmin4
  ports:
    - <%= offset_port(5050) %>:80
  environment:
    PGADMIN_DEFAULT_EMAIL: pgadmin4@pgadmin.org
    PGADMIN_DEFAULT_PASSWORD: devstack
    PGADMIN_CONFIG_SERVER_MODE: "False"
  volumes:
    - $HOME/.pgadmin:/var/lib/pgadmin
    - $HOME/.ssh:/root/.ssh
    - <%= file_path('servers.json') %>:/pgadmin4/servers.json
    - <%= file_path('pgpass') %>:/pgpass
files:
  servers.json: |
    {
        "Servers": {
            "1": {
                "Name": "devstack",
                "Group": "Servers",
                "Host": "<%= db_host %>",
                "Port": <%= offset_port(5432) %>,
                "MaintenanceDB": "postgres",
                "Username": "<%= db_username %>",
                "SSLMode": "prefer",
                "SSLCompression": 0,
                "Timeout": 0,
                "UseSSHTunnel": 0,
                "TunnelPort": "22",
                "TunnelAuthentication": 0,
                "PassFile": "/pgpass"
            }
        }
    }
  pgpass: |
    <%= db_host %>:<%= offset_port(5432) %>:postgres:<%= db_username %>:<%= db_password %>
